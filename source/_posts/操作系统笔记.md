---
title: 操作系统笔记
tags:
  - operator system
categories:
  - four fundamental computer technology
abbrlink: 8ce3e425
date: 2022-04-23 11:42:57
---

{% label primary@声明：%}
以下笔记内容摘自现代操作系统原理与实现.陈海波、夏虞斌 等著

<!-- more -->

## **操作系统概述**
---
操作系统有两个职责：对**硬件**进行管理和抽象，为**应用**提供服务并进行管理

![操作系统简要结构](/images/操作系统的简要结构.svg)

操作系统简史
- GM-NAA I/O: 第一个(批处理)操作系统
- OS/360: 从专用走向通用
- Multics/UNIX/Linux: 分时与多任务
- macOS/Windows: 以人为本的人机交互

操作系统接口
从应用角度，操作系统提供了不同层次的接口，主要包括：
- 系统调用接口
- POSIX接口
- 领域应用接口

![不同层次的操作系统接口](/images/不同层次操作系统接口.svg)

ChCore用于本书教学而开发的实验操作系统，基本结构如下所示：

![ChCore系统架构示意图](/images/ChCore系统架构示意图.svg)

## **硬件结构**
---
冯·诺伊曼结构包括三个主要部分：
- 中央处理单元
- 存储器
- 输入输出

![冯诺依曼结构示意图](/images/冯诺依曼结构示意图.svg)

ISA- Instruction Set Architecture - 指令集架构
- RISC(Reduced Instruction Set Computer)- 精简指令集计算机
- CISC(Complex Instruction Set Computer)- 复杂指令集计算机

RISC - AArch64
每条指令的长度固定4字节，指令类型包括：
- 数据搬移指令(mov)
- 寄存器计算指令(add/sub)
- 内存读写指令(ldr/str)
- 跳转指令(b)
- 过程调用指令(bl/ret)
- 特权指令(mrs/msr)

## **操作系统结构**
---
在构建复杂系统时，必须合理考虑其内部结构，在不同的需求之间进行**权衡**。

操作系统乃至计算机系统中控制复杂度的一个重要设计原则是：将**策略**与**机制**相分离。
策略表示“做什么”，机制表示“如何做”

<center><font color=#F78A52>典型的操作系统机制与策略</font></center>

||策略|机制|
|:---:|:---:|:---:|
|登录|什么用户、以什么权限登录等|输入处理、策略文件管理、桌面启动加载等|
|调度|先到先得、时间片轮转等|调度队列的设计、调度实体的表示、调度的中断处理等|
||||

管理复杂系统的重要方法是M.A.L.H方法，即
- 模块化(modularity)
- 抽象(abstraction)
- 分层(layering)
  - 不同类模块之间的层级
- 层级(hierarchy)
  - 同类模块之间的分层

操作系统内核架构：
- 简要结构
- 宏内核
- 微内核
- 外核
- 多核 & 混合内核

**简要结构**
一些功能较为简单的操作系统，会选择将应用程序与操作系统放置在同一个地址空间中，无需底层硬件提供复杂的内存管理、特权级隔离等功能。

典型示例：MS-DOS(MicrSoft Disk Operating System)
优点：应用程序对操作系统服务的调用无需切换地址空间和权限层级，因此更加高效。
缺点：任何一个应用或操作系统模块出现了问题，均有可能使整个系统崩溃。

**宏内核架构**
又称**单内核**，其特征是操作系统内核的所有模块(包括进程调度、内存管理、文件系统、设备驱动等)均运行在内核态，具备直接操作硬件的能力，这类操作系统包裹UNIX/Linux、FreeBSD等。

**微内核**
将单个功能或模块(如文件系统、设备驱动等)从内核中拆分出来，作为一个独立的服务部署到独立的运行环境中；内核仅保留极少的功能，为这些服务提供通信等基础能力，使其能够互相协作以完成操作系统所必需的功能。

**外核架构**
外核架构可以为不同应用提供定制化的高效资源管理：按照不同应用领域的要求，将对硬件资源的抽象模块化为一系列的库(即**LibOS**).


操作系统框架结构：
- Android 系统框架
- ROS 系统框架

**Android 系统框架**
在Linux内核之上运行的Android系统框架包括如下几个主要组件：
1. 硬件抽象层
2. Android库
3. Android运行环境
4. Android应用框架
5. 服务化架构与BinderIPC